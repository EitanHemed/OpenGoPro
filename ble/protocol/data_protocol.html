<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Protocol &mdash; Open GoPro BLE API 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/style.css?v=4391a3cb" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="State Management" href="state_management.html" />
    <link rel="prev" title="BLE Setup" href="ble_setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Open GoPro BLE API
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../protocol.html">Protocol</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ble_setup.html">BLE Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ble_setup.html#pairing-mode">Pairing Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_setup.html#advertisements">Advertisements</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_setup.html#finish-pairing">Finish Pairing</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_setup.html#configure-gatt-characteristics">Configure GATT Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ble_setup.html#ble-characteristics">BLE Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble_setup.html#send-messages">Send Messages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#packetization">Packetization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#packet-headers">Packet Headers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#decipher-message-payload-type">Decipher Message Payload Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#message-payload">Message Payload</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#type-length-value">Type Length Value</a></li>
<li class="toctree-l4"><a class="reference internal" href="#protobuf">Protobuf</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="state_management.html">State Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="state_management.html#camera-readiness">Camera Readiness</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_management.html#keep-alive">Keep Alive</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_management.html#camera-control">Camera Control</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="id_tables.html">ID Tables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="id_tables.html#command-ids">Command IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="id_tables.html#query-ids">Query IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="id_tables.html#protobuf-ids">Protobuf IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="id_tables.html#setting-ids">Setting IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="id_tables.html#status-ids">Status IDs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protobuf.html">Protobuf Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#enums">Enums</a><ul>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumcohnnetworkstate">EnumCOHNNetworkState</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumcohnstatus">EnumCOHNStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumcameracontrolstatus">EnumCameraControlStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumflatmode">EnumFlatMode</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumlens">EnumLens</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumlivestreamerror">EnumLiveStreamError</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumlivestreamstatus">EnumLiveStreamStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumpresetgroup">EnumPresetGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumpresetgroupicon">EnumPresetGroupIcon</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumpreseticon">EnumPresetIcon</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumpresettitle">EnumPresetTitle</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumprovisioning">EnumProvisioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumregisterlivestreamstatus">EnumRegisterLiveStreamStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumregisterpresetstatus">EnumRegisterPresetStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumresultgeneric">EnumResultGeneric</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumscanentryflags">EnumScanEntryFlags</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumscanning">EnumScanning</a></li>
<li class="toctree-l4"><a class="reference internal" href="protobuf.html#enumwindowsize">EnumWindowSize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#media">Media</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#notifprovisioningstate">NotifProvisioningState</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#notifstartscanning">NotifStartScanning</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#notifycohnstatus">NotifyCOHNStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#notifylivestreamstatus">NotifyLiveStreamStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#notifypresetstatus">NotifyPresetStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#preset">Preset</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#presetgroup">PresetGroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#presetsetting">PresetSetting</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestcohncert">RequestCOHNCert</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestclearcohncert">RequestClearCOHNCert</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestconnect">RequestConnect</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestconnectnew">RequestConnectNew</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestcreatecohncert">RequestCreateCOHNCert</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestcustompresetupdate">RequestCustomPresetUpdate</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestgetapentries">RequestGetApEntries</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestgetcohnstatus">RequestGetCOHNStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestgetlastcapturedmedia">RequestGetLastCapturedMedia</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestgetlivestreamstatus">RequestGetLiveStreamStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestgetpresetstatus">RequestGetPresetStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestreleasenetwork">RequestReleaseNetwork</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestsetcohnsetting">RequestSetCOHNSetting</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestsetcameracontrolstatus">RequestSetCameraControlStatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestsetlivestreammode">RequestSetLiveStreamMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requestsetturboactive">RequestSetTurboActive</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#requeststartscan">RequestStartScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responsecohncert">ResponseCOHNCert</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responseconnect">ResponseConnect</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responseconnectnew">ResponseConnectNew</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responsegeneric">ResponseGeneric</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responsegetapentries">ResponseGetApEntries</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responselastcapturedmedia">ResponseLastCapturedMedia</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responsestartscanning">ResponseStartScanning</a></li>
<li class="toctree-l3"><a class="reference internal" href="protobuf.html#responsegetapentries-scanentry">ResponseGetApEntries::ScanEntry</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/control.html">Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/control.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#keep_alive"><code class="docutils literal notranslate"><span class="pre">Keep</span> <span class="pre">Alive</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_analytics"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Analytics</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_ap_control"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">AP</span> <span class="pre">Control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_camera_control"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Camera</span> <span class="pre">Control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_date_time"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Date</span> <span class="pre">Time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_local_date_time"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Local</span> <span class="pre">Date</span> <span class="pre">Time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_shutter"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Shutter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#set_turbo_transfer"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Turbo</span> <span class="pre">Transfer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/control.html#sleep"><code class="docutils literal notranslate"><span class="pre">Sleep</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/query.html">Query</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/query.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_open_gopro_version"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Open</span> <span class="pre">GoPro</span> <span class="pre">Version</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_date_time"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Date</span> <span class="pre">Time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_hardware_info"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Hardware</span> <span class="pre">Info</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_local_date_time"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Local</span> <span class="pre">Date</span> <span class="pre">Time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_last_captured_media"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Last</span> <span class="pre">Captured</span> <span class="pre">Media</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_setting_values"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Setting</span> <span class="pre">Values</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_status_values"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Status</span> <span class="pre">Values</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#get_setting_capabilities"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Setting</span> <span class="pre">Capabilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#register_for_setting_value_updates"><code class="docutils literal notranslate"><span class="pre">Register</span> <span class="pre">for</span> <span class="pre">Setting</span> <span class="pre">Value</span> <span class="pre">Updates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#register_for_status_value_updates"><code class="docutils literal notranslate"><span class="pre">Register</span> <span class="pre">for</span> <span class="pre">Status</span> <span class="pre">Value</span> <span class="pre">Updates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#register_for_setting_capability_updates"><code class="docutils literal notranslate"><span class="pre">Register</span> <span class="pre">for</span> <span class="pre">Setting</span> <span class="pre">Capability</span> <span class="pre">Updates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#unregister_for_setting_value_updates"><code class="docutils literal notranslate"><span class="pre">Unregister</span> <span class="pre">for</span> <span class="pre">Setting</span> <span class="pre">Value</span> <span class="pre">Updates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#unregister_for_status_value_updates"><code class="docutils literal notranslate"><span class="pre">Unregister</span> <span class="pre">for</span> <span class="pre">Status</span> <span class="pre">Value</span> <span class="pre">Updates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/query.html#unregister_for_setting_capability_updates"><code class="docutils literal notranslate"><span class="pre">Unregister</span> <span class="pre">for</span> <span class="pre">Setting</span> <span class="pre">Capability</span> <span class="pre">Updates</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/access_points.html">Access Point</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/access_points.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/access_points.html#scan_for_access_points"><code class="docutils literal notranslate"><span class="pre">Scan</span> <span class="pre">for</span> <span class="pre">Access</span> <span class="pre">Points</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/access_points.html#get_ap_scan_results"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">AP</span> <span class="pre">Scan</span> <span class="pre">Results</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/access_points.html#connect_to_provisioned_access_point"><code class="docutils literal notranslate"><span class="pre">Connect</span> <span class="pre">to</span> <span class="pre">Provisioned</span> <span class="pre">Access</span> <span class="pre">Point</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/access_points.html#connect_to_a_new_access_point"><code class="docutils literal notranslate"><span class="pre">Connect</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">New</span> <span class="pre">Access</span> <span class="pre">Point</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/access_points.html#disconnect-from-access-point">Disconnect from Access Point</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/live_streaming.html">Live Streaming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/live_streaming.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/live_streaming.html#set_livestream_mode"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Livestream</span> <span class="pre">Mode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/live_streaming.html#get_livestream_status"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Livestream</span> <span class="pre">Status</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/cohn.html">Camera on the Home Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/cohn.html#certificates">Certificates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#verifying-certificate">Verifying Certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#view-certificate-details">View Certificate Details</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/cohn.html#provisioning-procedure">Provisioning Procedure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features/cohn.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#clear_cohn_certificate"><code class="docutils literal notranslate"><span class="pre">Clear</span> <span class="pre">COHN</span> <span class="pre">Certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#create_cohn_certificate"><code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">COHN</span> <span class="pre">Certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#get_cohn_certificate"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">COHN</span> <span class="pre">Certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#get_cohn_status"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">COHN</span> <span class="pre">Status</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/cohn.html#set_cohn_setting"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">COHN</span> <span class="pre">Setting</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/hilights.html">Hilights</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/hilights.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/hilights.html#hilight_moment"><code class="docutils literal notranslate"><span class="pre">Hilight</span> <span class="pre">Moment</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/presets.html">Presets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/presets.html#preset-groups">Preset Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features/presets.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/presets.html#get_available_presets"><code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">Available</span> <span class="pre">Presets</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/presets.html#load_preset"><code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">Preset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/presets.html#load_preset_group"><code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">Preset</span> <span class="pre">Group</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/presets.html#update_custom_preset"><code class="docutils literal notranslate"><span class="pre">Update</span> <span class="pre">Custom</span> <span class="pre">Preset</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/settings.html">Settings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../features/settings.html#camera-capabilities">Camera Capabilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/settings.html#xlsx">XLSX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features/settings.html#json">JSON</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/settings.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../features/settings.html#set_setting"><code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Setting</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../features/settings.html#setting-ids">Setting IDs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../features/statuses.html">Statuses</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Open GoPro BLE API</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../protocol.html">Protocol</a></li>
      <li class="breadcrumb-item active">Data Protocol</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/protocol/data_protocol.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-protocol">
<h1>Data Protocol<a class="headerlink" href="#data-protocol" title="Link to this heading"></a></h1>
<p>Note the following terminology used in this section:</p>
<ul class="simple">
<li><p><strong>packet</strong>: GATT-level byte data including packet headers</p></li>
<li><p><strong>message</strong>: Payload data accumulated from one or more packets (not including packet headers)</p></li>
</ul>
<p>This section will describe the data protocol used to send and receive BLE messages. The general procedure to parse a
message is to:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#packetization"><span class="std std-ref">Accumulate and depacketize</span></a> BLE packets to extract the message payload</p></li>
<li><p><a class="reference internal" href="#decipher-message-payload-type"><span class="std std-ref">Decipher</span></a> the message’s ID and payload type</p></li>
<li><p>Depending on the <a class="reference internal" href="#message-payload"><span class="std std-ref">payload type</span></a>, use the per-message documentation
(identified by the message’s ID) to parse the message</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All byte ordering is in Big Endian unless otherwise noted.</p>
</div>
<section id="packetization">
<h2>Packetization<a class="headerlink" href="#packetization" title="Link to this heading"></a></h2>
<p>The BLE protocol (&lt;= v4.2) limits packet size to 20 bytes per packet. To accommodate this limitation, GoPro
cameras use start and continuation packets to packetize larger payloads. If a message is less than 20 bytes, it
can be sent with a single packet containing the start packet header. Otherwise,
it must be split into multiple packets with the first packet containing a start packet header and subsequent packets
containing continuation packet headers.</p>
<section id="packet-headers">
<h3>Packet Headers<a class="headerlink" href="#packet-headers" title="Link to this heading"></a></h3>
<p>Message sending and receiving is accomplished by prepending <strong>General (5-bit)</strong>, <strong>Extended (13-bit)</strong>,
<strong>Extended (16-bit)</strong>, or <strong>Continuation</strong> headers onto each packet depending on the message size and state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For byte-level examples of the below packet types, see the
<a class="reference external" href="https://gopro.github.io/OpenGoPro/tutorials/parse-ble-responses#parsing-multiple-packet-tlv-responses">tutorials</a></p>
</div>
<section id="general-5-bit-packets">
<h4>General (5-bit) Packets<a class="headerlink" href="#general-5-bit-packets" title="Link to this heading"></a></h4>
<p>Messages that are 31 bytes or fewer can be sent or received using the following format:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="8"><p>Byte 0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Start (0)</p></td>
<td colspan="2"><p>General (00)</p></td>
<td colspan="5"><p>5-bit Message Length</p></td>
</tr>
</tbody>
</table>
</section>
<section id="extended-13-bit-packets">
<h4>Extended (13-bit) Packets<a class="headerlink" href="#extended-13-bit-packets" title="Link to this heading"></a></h4>
<p>Messages that are 8191 bytes or fewer can be sent or received using the following format:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="8"><p>Byte 0</p></th>
<th class="head" colspan="8"><p>Byte 1</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Start (0)</p></td>
<td colspan="2"><p>13-bit Extended (01)</p></td>
<td colspan="13"><p>13-bit Message Length</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Always use Extended (13-bit) packet headers when sending messages to avoid having to work with multiple packet
header formats.</p>
</div>
</section>
<section id="extended-16-bit-packets">
<h4>Extended (16-bit) Packets<a class="headerlink" href="#extended-16-bit-packets" title="Link to this heading"></a></h4>
<p>If a message is 8192 bytes or longer, the camera will respond using the format below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="8"><p>Byte 0</p></th>
<th class="head" colspan="8"><p>Byte 1</p></th>
<th class="head" colspan="8"><p>Byte 2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Start (0)</p></td>
<td colspan="2"><p>13-bit Extended (10)</p></td>
<td colspan="5"><p>Reserved</p></td>
<td colspan="16"><p>16-bit Message Length</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This format can not be used for sending messages to the camera. It is only used to receive messages.</p>
</div>
</section>
<section id="continuation-packets">
<h4>Continuation Packets<a class="headerlink" href="#continuation-packets" title="Link to this heading"></a></h4>
<p>When sending or receiving a message that is longer than 20 bytes, the message must be split into N packets with packet 1
containing a start packet header and packets 2..N containing a continuation packet header.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Counters start at 0x0 and reset after 0xF.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head" colspan="8"><p>Byte 0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7</p></td>
<td><p>6</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Continuation (1)</p></td>
<td colspan="3"><p>Reserved</p></td>
<td colspan="4"><p>4-bit Counter</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="decipher-message-payload-type">
<h2>Decipher Message Payload Type<a class="headerlink" href="#decipher-message-payload-type" title="Link to this heading"></a></h2>
<p>Once the packets have been accumulated and the payload has been extracted, it is necessary to decipher the message type
in order to determine whether it is TLV or Protobuf and then parse it appropriately.</p>
<p>Below is pseudocode describing how to do this:</p>
<pre class="literal-block">Camera sends response message from UUID U (string) with payload P (array of bytes)
// Is it a Protobuf response?
for each row in the <a class="reference internal" href="id_tables.html#protobuf-ids"><span class="std std-ref">Protobuf IDs table</span></a> {
    F (int) = Feature ID
    A (array of int) = Action IDs
    if P[0] == F and P[1] in A {
        P is a <a class="reference internal" href="#protobuf"><span class="std std-ref">Protobuf Message</span></a>
        Match Feature ID P[0] and Action ID P[1] to a Protobuf message in the <a class="reference internal" href="id_tables.html#protobuf-ids"><span class="std std-ref">Protobuf IDs table</span></a>
        Use matched <a class="reference internal" href="protobuf.html"><span class="doc">Protobuf message</span></a> to parse byte payload into useful data structure
        Exit
    }
}
// Nope. It is a TLV response
if U == GP-0072 (Command) {
    Parse message payload using <a class="reference internal" href="id_tables.html#command-ids"><span class="std std-ref">Command Table</span></a> with <a class="reference internal" href="#commands"><span class="std std-ref">Command scheme</span></a>
}
else if U == GP-0074 (Settings) {
    Parse using <a class="reference internal" href="id_tables.html#setting-ids"><span class="std std-ref">Setting ID mapping</span></a> with <a class="reference internal" href="#commands"><span class="std std-ref">Command scheme</span></a>
}
else if U == GP-0076 (Query) {
    Parse message payload using <a class="reference internal" href="id_tables.html#query-ids"><span class="std std-ref">Query Table</span></a> with <a class="reference internal" href="#queries"><span class="std std-ref">Query scheme</span></a>
}</pre>
<p>Alternatively this is described in flowchart form here:</p>
<img alt="../_images/plantuml_ble_tlv_vs_protobuf.png" src="../_images/plantuml_ble_tlv_vs_protobuf.png" />
</section>
<section id="message-payload">
<h2>Message Payload<a class="headerlink" href="#message-payload" title="Link to this heading"></a></h2>
<p>Once the payload has been extracted and had its type deciphered, it can then be parsed depending on its type.
The Open GoPro protocol uses two different top-level message payload formats:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#type-length-value"><span class="std std-ref">Type Length Value (TLV)</span></a></p></li>
<li><p><a class="reference internal" href="#protobuf"><span class="std std-ref">Protobuf</span></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The byte table examples in this section do not contain the <a class="reference internal" href="#packet-headers"><span class="std std-ref">Packet Headers</span></a>; they only consider the payload.</p>
</div>
<section id="type-length-value">
<h3>Type Length Value<a class="headerlink" href="#type-length-value" title="Link to this heading"></a></h3>
<p>There are two different request / response Type-Length-Value (TLV) schemes as described in the following sections.</p>
<section id="commands">
<h4>Commands<a class="headerlink" href="#commands" title="Link to this heading"></a></h4>
<p>Commands are messages sent / received on either:</p>
<ul class="simple">
<li><p>The Command and Command Response <a class="reference internal" href="ble_setup.html#ble-characteristics"><span class="std std-ref">characteristics</span></a></p></li>
<li><p>The Setting and Setting Response <a class="reference internal" href="ble_setup.html#ble-characteristics"><span class="std std-ref">characteristics</span></a></p></li>
</ul>
<p>They are summarized in the <a class="reference internal" href="id_tables.html#command-ids"><span class="std std-ref">commands table</span></a> and individually documented throughout
the relevant feature section.</p>
<p class="rubric">Command Request</p>
<p>Below is the top level message format for command requests:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type (Command / Setting ID)</p></th>
<th class="head"><p>Optional Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p>Array of length-value pairs</p></td>
</tr>
</tbody>
</table>
<p>where each element of the parameter array is:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Length</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p><strong>Length</strong> Bytes</p></td>
</tr>
</tbody>
</table>
<p>The individual command documentation specified by the message’s <a class="reference internal" href="id_tables.html#command-ids"><span class="std std-ref">Command ID</span></a>
will define the length and value options for each of its parameters.</p>
<p class="rubric">Command Response</p>
<p>Below is the top level message format for command responses:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type (Command / Setting ID)</p></th>
<th class="head"><p>Command Status</p></th>
<th class="head"><p>Optional Response</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p>1 Byte</p></td>
<td><p>Variable Length</p></td>
</tr>
</tbody>
</table>
<p>The individual command documentation specified by the message’s
<a class="reference internal" href="id_tables.html#command-ids"><span class="std std-ref">Command ID</span></a> will define the response.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For byte-level examples, see the
<a class="reference external" href="https://gopro.github.io/OpenGoPro/tutorials/send-ble-commands#sending-commands">tutorials</a>.</p>
</div>
</section>
<section id="queries">
<h4>Queries<a class="headerlink" href="#queries" title="Link to this heading"></a></h4>
<p>Queries are messages sent / received on the Query and Query Response <a class="reference internal" href="ble_setup.html#ble-characteristics"><span class="std std-ref">characteristics</span></a>,
respectively. They are summarized in the <a class="reference internal" href="id_tables.html#query-ids"><span class="std std-ref">queries table</span></a> and individually documented
in <a class="reference internal" href="../features/query.html"><span class="doc">Query</span></a>.</p>
<p class="rubric">Query Request</p>
<p>Below is the top level message format for query requests:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Query ID</p></th>
<th class="head"><p>Array of Element IDs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p>Variable</p></td>
</tr>
</tbody>
</table>
<p>The individual query documentation specified by the message’s <a class="reference internal" href="id_tables.html#query-ids"><span class="std std-ref">Query ID</span></a>
will define the elements that comprise the element ID array.</p>
<p class="rubric">Query Response</p>
<p>Below is the top level message format for query responses:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Query ID</p></th>
<th class="head"><p>Command Status</p></th>
<th class="head"><p>Query Results</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p>1 Byte</p></td>
<td><p>Array of id-length-value triplets</p></td>
</tr>
</tbody>
</table>
<p>where each element of the results array is:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ID</p></th>
<th class="head"><p>Length</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p>1 byte</p></td>
<td><p><strong>Length</strong> Bytes</p></td>
</tr>
</tbody>
</table>
<p>The individual query documentation specified by the message’s
<a class="reference internal" href="id_tables.html#query-ids"><span class="std std-ref">Query ID</span></a> will define the format of the result array.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For byte-level examples, see the
<a class="reference external" href="https://gopro.github.io/OpenGoPro/tutorials/parse-ble-responses#parsing-a-one-packet-tlv-response">tutorials</a>.</p>
</div>
</section>
</section>
<section id="protobuf">
<h3>Protobuf<a class="headerlink" href="#protobuf" title="Link to this heading"></a></h3>
<p>In order to maximize BLE bandwidth, some commands use <a class="reference external" href="https://developers.google.com/protocol-buffers">Google Protobuf (Protocol Buffers)</a>.
Open GoPro currently uses Protocol Buffers <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/proto2-spec">Version 2</a></p>
<p>Protobuf requests and responses are identified by a Feature ID and an Action ID prepended before their serialized payload.
The top level message format for a Protobuf message is as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Feature ID</p></th>
<th class="head"><p>Action ID</p></th>
<th class="head"><p>Serialized Protobuf Message</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 Byte</p></td>
<td><p>1 Byte</p></td>
<td><p>Variable Length</p></td>
</tr>
</tbody>
</table>
<p>The individual Protobuf object specified by the message’s
<a class="reference internal" href="id_tables.html#protobuf-ids"><span class="std std-ref">action / feature id</span></a> is used to serialize / deserialize the payload.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ble_setup.html" class="btn btn-neutral float-left" title="BLE Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="state_management.html" class="btn btn-neutral float-right" title="State Management" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>